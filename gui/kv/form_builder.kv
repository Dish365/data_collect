<FormBuilderScreen>:
    MDBoxLayout:
        orientation: 'vertical'

        TopBar:
            id: top_bar
            left_action_items: [["arrow-left", lambda x: root.manager.change_screen('projects', 'right')]]
            right_action_items: [["content-save", lambda x: root.save_form()]]

        MDBoxLayout:
            orientation: 'vertical'
            padding: dp(10)
            spacing: dp(10)

            # Project Selector
            MDBoxLayout:
                orientation: 'horizontal'
                size_hint_y: None
                height: dp(56)
                spacing: dp(10)

                MDLabel:
                    text: "Select Project:"
                    size_hint_x: None
                    width: dp(120)
                    font_style: "Subtitle1"
                    valign: 'middle'

                MDDropDownItem:
                    id: project_spinner
                    text: 'Select Project'
                    on_release: root.open_project_menu()
                    pos_hint: {'center_y': 0.5}
                    md_bg_color: app.theme_cls.primary_light
                    radius: [12, 12, 12, 12]
                    font_size: '18sp'

            # Main content layout: Left and Right Panel
            MDBoxLayout:
                orientation: 'horizontal'
                spacing: dp(16)

                # Left Panel - Question Types (centered vertically)
                MDBoxLayout:
                    orientation: 'vertical'
                    size_hint_x: 0.3
                    padding: 0
                    spacing: 0

                    MDCard:
                        orientation: 'vertical'
                        size_hint_y: None
                        height: self.minimum_height
                        padding: dp(16)
                        spacing: dp(12)
                        radius: [16, 16, 16, 16]
                        elevation: 1
                        md_bg_color: app.theme_cls.bg_light

                        MDLabel:
                            text: "Question Types"
                            font_style: "H6"
                            size_hint_y: None
                            height: self.texture_size[1]
                            bold: True

                        MDBoxLayout:
                            orientation: 'vertical'
                            spacing: dp(10)
                            size_hint_y: None
                            height: self.minimum_height

                            MDRaisedButton:
                                text: "Short Text"
                                on_release: root.add_question('text')
                                size_hint_y: None
                                height: dp(40)
                                md_bg_color: app.theme_cls.primary_color
                                text_color: 1, 1, 1, 1

                            MDRaisedButton:
                                text: "Multiple Choice"
                                on_release: root.add_question('choice')
                                size_hint_y: None
                                height: dp(40)
                                md_bg_color: app.theme_cls.primary_color
                                text_color: 1, 1, 1, 1

                            MDRaisedButton:
                                text: "Long Text"
                                on_release: root.add_question('long_text')
                                size_hint_y: None
                                height: dp(40)
                                md_bg_color: app.theme_cls.primary_color
                                text_color: 1, 1, 1, 1

                    Widget:  # Bottom Spacer

                # Right Panel - Form Canvas
                MDBoxLayout:
                    orientation: 'vertical'
                    size_hint_x: 0.7
                    spacing: dp(10)

                    MDScrollView:
                        MDBoxLayout:
                            id: form_canvas
                            orientation: 'vertical'
                            spacing: dp(12)
                            adaptive_height: True
                            padding: dp(10)

                    MDBoxLayout:
                        orientation: 'horizontal'
                        size_hint_y: None
                        height: dp(56)
                        spacing: dp(16)
                        padding: [dp(10), 0, dp(10), dp(10)]
                        MDRaisedButton:
                            text: "Save"
                            md_bg_color: app.theme_cls.primary_color
                            text_color: 1, 1, 1, 1
                            on_release: root.save_form()
                        MDRaisedButton:
                            text: "Preview Questions"
                            md_bg_color: app.theme_cls.primary_color
                            text_color: 1, 1, 1, 1
                            on_release: root.preview_questions()

                    MDSpinner:
                        id: spinner
                        size_hint: None, None
                        size: dp(46), dp(46)
                        pos_hint: {'center_x': .5, 'center_y': .5}
                        active: False
