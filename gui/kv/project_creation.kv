#:import dp kivy.metrics.dp
#:import MDCard kivymd.uix.card.MDCard
#:import Animation kivy.animation.Animation

<ProjectCreationScreen>:
    name: 'project_creation'
    md_bg_color: app.theme_cls.surfaceColor
    
    # Background gradient effect
    MDFloatLayout:
        MDCard:
            orientation: "vertical"
            size_hint: 1, 1
            pos_hint: {'center_x': 0.5, 'center_y': 0.5}
            elevation: 0
            radius: [0]
            md_bg_color: app.theme_cls.surfaceColor
            style: "filled"
            
            # Subtle background pattern
            MDIcon:
                icon: "folder-multiple-outline"
                size_hint: None, None
                size: dp(200), dp(200)
                pos_hint: {'center_x': 0.9, 'center_y': 0.8}
                theme_icon_color: "Custom"
                icon_color: app.theme_cls.surfaceVariantColor[:-1] + [0.05]
    
    MDScrollView:
        id: scroll_view
        do_scroll_x: False
        size_hint: 1, 1
        effect_cls: "ScrollEffect"
        
        MDBoxLayout:
            id: main_content
            orientation: 'vertical'
            adaptive_height: True
            size_hint: 1, None
            height: self.minimum_height
            padding: [dp(32), dp(24), dp(32), dp(24)]
            spacing: dp(28)
            
            # Enhanced Header section with hero styling
            MDCard:
                orientation: "vertical"
                adaptive_height: True
                size_hint: 1, None
                height: self.minimum_height
                padding: [dp(28), dp(24), dp(28), dp(24)]
                spacing: dp(16)
                radius: [dp(16)]
                style: "filled"
                elevation: 1
                md_bg_color: app.theme_cls.primaryColor[:-1] + [0.12]
                
                MDBoxLayout:
                    orientation: "horizontal"
                    adaptive_height: True
                    size_hint_y: None
                    height: dp(56)
                    spacing: dp(16)
                    
                    MDIconButton:
                        icon: "arrow-left"
                        size_hint: None, None
                        size: dp(48), dp(48)
                        theme_icon_color: "Custom"
                        icon_color: app.theme_cls.primaryColor
                        style: "standard"
                        on_release: root.on_cancel_pressed()
                    
                    MDBoxLayout:
                        orientation: "vertical"
                        adaptive_height: True
                        size_hint_y: None
                        height: self.minimum_height
                        spacing: dp(4)
                        
                        MDLabel:
                            text: "Create New Project"
                            font_style: "Headline"
                            role: "small"
                            theme_text_color: "Custom"
                            text_color: app.theme_cls.primaryColor
                            size_hint_y: None
                            height: dp(32)
                            bold: True
                        
                        MDLabel:
                            text: "Build something amazing"
                            font_style: "Body"
                            role: "medium"
                            theme_text_color: "Custom"
                            text_color: app.theme_cls.primaryColor[:-1] + [0.8]
                            size_hint_y: None
                            height: dp(20)
                
                Widget:
                    size_hint_y: None
                    height: dp(8)
                
                MDLabel:
                    text: "Set up your new data collection project with detailed information. Choose a memorable name and describe your project's goals."
                    font_style: "Body"
                    role: "medium"
                    theme_text_color: "Custom"
                    text_color: app.theme_cls.primaryColor[:-1] + [0.9]
                    adaptive_height: True
                    size_hint_y: None
                    height: self.texture_size[1]
            
            # Enhanced Form section
            MDCard:
                orientation: 'vertical'
                adaptive_height: True
                size_hint: 1, None
                height: self.minimum_height
                padding: [dp(32), dp(32), dp(32), dp(32)]
                spacing: dp(24)
                radius: [dp(16)]
                style: "elevated"
                elevation: 3
                md_bg_color: app.theme_cls.surfaceVariantColor
                
                # Enhanced Project name field with better visual hierarchy
                MDBoxLayout:
                    orientation: "vertical"
                    adaptive_height: True
                    size_hint_y: None
                    height: self.minimum_height
                    spacing: dp(12)
                    
                    MDBoxLayout:
                        orientation: "horizontal"
                        adaptive_height: True
                        size_hint_y: None
                        height: dp(28)
                        spacing: dp(8)
                        
                        MDIcon:
                            icon: "folder-star-outline"
                            size_hint: None, None
                            size: dp(20), dp(20)
                            theme_icon_color: "Primary"
                            pos_hint: {"center_y": 0.5}
                        
                        MDLabel:
                            text: "Project Name"
                            font_style: "Title"
                            role: "medium"
                            theme_text_color: "Primary"
                            size_hint_y: None
                            height: dp(28)
                            valign: "center"
                            bold: True
                        
                        MDLabel:
                            text: "*"
                            font_style: "Title"
                            role: "medium"
                            theme_text_color: "Error"
                            size_hint: None, None
                            size: dp(12), dp(28)
                            valign: "center"
                    
                    MDTextField:
                        id: name_field
                        mode: "outlined"
                        size_hint_y: None
                        height: dp(72)
                        required: True
                        max_text_length: 100
                        radius: [dp(12)]
                        line_color_focus: app.theme_cls.primaryColor
                        on_text: root.on_name_change(self, self.text)
                        on_text_validate: root.on_enter_pressed(self)
                        
                        MDTextFieldHintText:
                            text: "e.g., Customer Satisfaction Survey 2024"
                        
                        MDTextFieldHelperText:
                            text: "Choose a clear, descriptive name (2-100 characters)"
                            mode: "persistent"
                        
                        MDTextFieldMaxLengthText:
                            max_text_length: 100
                        
                        MDTextFieldLeadingIcon:
                            icon: "folder-edit-outline"
                
                # Enhanced Project description field
                MDBoxLayout:
                    orientation: "vertical"
                    adaptive_height: True
                    size_hint_y: None
                    height: self.minimum_height
                    spacing: dp(12)
                    
                    MDBoxLayout:
                        orientation: "horizontal"
                        adaptive_height: True
                        size_hint_y: None
                        height: dp(28)
                        spacing: dp(8)
                        
                        MDIcon:
                            icon: "text-box-edit-outline"
                            size_hint: None, None
                            size: dp(20), dp(20)
                            theme_icon_color: "Primary"
                            pos_hint: {"center_y": 0.5}
                        
                        MDLabel:
                            text: "Project Description"
                            font_style: "Title"
                            role: "medium"
                            theme_text_color: "Primary"
                            size_hint_y: None
                            height: dp(28)
                            valign: "center"
                            bold: True
                        
                        MDLabel:
                            text: "(Optional)"
                            font_style: "Body"
                            role: "small"
                            theme_text_color: "Secondary"
                            size_hint_y: None
                            height: dp(28)
                            valign: "center"
                    
                    MDTextField:
                        id: description_field
                        mode: "outlined"
                        multiline: True
                        size_hint_y: None
                        height: dp(140)
                        max_text_length: 500
                        radius: [dp(12)]
                        line_color_focus: app.theme_cls.primaryColor
                        on_text: root.on_description_change(self, self.text)
                        on_text_validate: root.on_enter_pressed(self)
                        
                        MDTextFieldHintText:
                            text: "Describe your project's purpose, target audience, methodology, or expected outcomes..."
                        
                        MDTextFieldHelperText:
                            text: "Add context to help team members understand the project's goals"
                            mode: "persistent"
                        
                        MDTextFieldMaxLengthText:
                            max_text_length: 500
                        
                        MDTextFieldLeadingIcon:
                            icon: "notebook-edit-outline"
                
                # Enhanced Error message container with animation
                MDCard:
                    id: error_container
                    orientation: "horizontal"
                    adaptive_height: True
                    size_hint: 1, None
                    height: dp(48)
                    spacing: dp(12)
                    padding: [dp(16), dp(8), dp(16), dp(8)]
                    radius: [dp(8)]
                    opacity: 0
                    md_bg_color: app.theme_cls.errorColor[:-1] + [0.1]
                    style: "filled"
                    elevation: 0
                    
                    MDIcon:
                        icon: "alert-circle"
                        size_hint: None, None
                        size: dp(20), dp(20)
                        theme_icon_color: "Custom"
                        icon_color: app.theme_cls.errorColor
                        pos_hint: {"center_y": 0.5}
                    
                    MDLabel:
                        id: error_label
                        text: ""
                        theme_text_color: "Custom"
                        text_color: app.theme_cls.errorColor
                        font_style: "Body"
                        role: "medium"
                        size_hint_y: None
                        height: dp(32)
                        valign: "center"
            
            # Enhanced Project features preview with better visual appeal
            MDCard:
                orientation: 'vertical'
                adaptive_height: True
                size_hint: 1, None
                height: self.minimum_height
                padding: [dp(28), dp(24), dp(28), dp(24)]
                spacing: dp(20)
                radius: [dp(16)]
                style: "outlined"
                line_color: app.theme_cls.primaryColor
                
                MDBoxLayout:
                    orientation: "horizontal"
                    adaptive_height: True
                    size_hint_y: None
                    height: dp(36)
                    spacing: dp(12)
                    
                    MDIcon:
                        icon: "rocket-launch-outline"
                        size_hint: None, None
                        size: dp(28), dp(28)
                        theme_icon_color: "Primary"
                        pos_hint: {"center_y": 0.5}
                    
                    MDLabel:
                        text: "What You'll Get"
                        font_style: "Title"
                        role: "medium"
                        theme_text_color: "Primary"
                        size_hint_y: None
                        height: dp(36)
                        valign: "center"
                        bold: True
                
                MDGridLayout:
                    cols: 1
                    adaptive_height: True
                    size_hint_y: None
                    height: self.minimum_height
                    spacing: dp(12)
                    
                    MDBoxLayout:
                        orientation: "horizontal"
                        adaptive_height: True
                        size_hint_y: None
                        height: dp(24)
                        spacing: dp(12)
                        
                        MDIcon:
                            icon: "form-select"
                            size_hint: None, None
                            size: dp(20), dp(20)
                            theme_icon_color: "Secondary"
                            pos_hint: {"center_y": 0.5}
                        
                        MDLabel:
                            text: "Customizable data collection forms and surveys"
                            font_style: "Body"
                            role: "medium"
                            theme_text_color: "Primary"
                            size_hint_y: None
                            height: dp(24)
                            valign: "center"
                    
                    MDBoxLayout:
                        orientation: "horizontal"
                        adaptive_height: True
                        size_hint_y: None
                        height: dp(24)
                        spacing: dp(12)
                        
                        MDIcon:
                            icon: "sync"
                            size_hint: None, None
                            size: dp(20), dp(20)
                            theme_icon_color: "Secondary"
                            pos_hint: {"center_y": 0.5}
                        
                        MDLabel:
                            text: "Real-time synchronization across all devices"
                            font_style: "Body"
                            role: "medium"
                            theme_text_color: "Primary"
                            size_hint_y: None
                            height: dp(24)
                            valign: "center"
                    
                    MDBoxLayout:
                        orientation: "horizontal"
                        adaptive_height: True
                        size_hint_y: None
                        height: dp(24)
                        spacing: dp(12)
                        
                        MDIcon:
                            icon: "chart-line"
                            size_hint: None, None
                            size: dp(20), dp(20)
                            theme_icon_color: "Secondary"
                            pos_hint: {"center_y": 0.5}
                        
                        MDLabel:
                            text: "Advanced analytics and insightful reporting"
                            font_style: "Body"
                            role: "medium"
                            theme_text_color: "Primary"
                            size_hint_y: None
                            height: dp(24)
                            valign: "center"
                    
                    MDBoxLayout:
                        orientation: "horizontal"
                        adaptive_height: True
                        size_hint_y: None
                        height: dp(24)
                        spacing: dp(12)
                        
                        MDIcon:
                            icon: "account-group"
                            size_hint: None, None
                            size: dp(20), dp(20)
                            theme_icon_color: "Secondary"
                            pos_hint: {"center_y": 0.5}
                        
                        MDLabel:
                            text: "Seamless team collaboration and sharing"
                            font_style: "Body"
                            role: "medium"
                            theme_text_color: "Primary"
                            size_hint_y: None
                            height: dp(24)
                            valign: "center"
            
            # Enhanced Action buttons with better styling
            MDCard:
                orientation: "horizontal"
                adaptive_height: True
                size_hint: 1, None
                height: dp(72)
                padding: [dp(24), dp(16), dp(24), dp(16)]
                spacing: dp(16)
                radius: [dp(16)]
                style: "filled"
                elevation: 0
                md_bg_color: app.theme_cls.surfaceColor
                
                Widget:  # Spacer
                
                MDButton:
                    id: cancel_button
                    style: "outlined"
                    size_hint: None, None
                    size: dp(120), dp(48)
                    radius: [dp(24)]
                    on_release: root.on_cancel_pressed()
                    
                    MDButtonText:
                        text: "Cancel"
                        font_style: "Label"
                        role: "large"
                
                MDButton:
                    id: create_button
                    style: "filled"
                    size_hint: None, None
                    size: dp(160), dp(48)
                    disabled: True
                    radius: [dp(24)]
                    elevation: 2
                    on_release: root.on_create_pressed()
                    
                    MDButtonText:
                        text: "Create Project"
                        font_style: "Label"
                        role: "large"
            
            # Bottom spacing with subtle fade effect
            Widget:
                size_hint_y: None
                height: dp(32)